<!DOCTYPE html>
<html lang="en">
  
<head>
  <meta charset="UTF-8" />
  <title>BandForge IELTS — Free IELTS Preparation Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { color-scheme: light; }
    * { box-sizing: border-box; }

    /* -----------------------
       GLOBAL / SINGLE-VIEW
    ----------------------- */
    /*
       The default height of html/body was 100%, which prevented the page
       from scrolling when content exceeded one viewport. Replace this with
       a minimum height so the document can grow naturally.
     */
    html, body { min-height: 100%; height: auto; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue",
                   Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
      margin: 0; padding: 0;
      background: #fff; color: #111;
      scroll-behavior: smooth;
    }
    a { color: inherit; text-decoration: none; }

    /* Lock page scroll in single-view mode */
    body.no-scroll {
      overflow: hidden;
      position: fixed;
      inset: 0;
      width: 100%;
    }

    /* Only show the active page */
    header#home, section { display: none; }
    header#home.active, section.active { display: block; }

    /* -----------------------
       HOME (Professional, resource-first)
       — fixed viewport with an internal scroller
    ----------------------- */
    header#home{
      /* Let the home section grow naturally, ensuring full-page scroll */
      height: auto;
      position: relative;
      padding: 0; /* we'll handle padding per block */
      color: #0b0c0f;
      background: #0b0c0f;      /* base for layered media */
      overflow-x: hidden;
      overflow-y: visible;
      overscroll-behavior: contain;
      -webkit-overflow-scrolling: touch;
      scroll-padding-top: 80px;
    }

    /* background media */
    .home-hero{
      position: relative;
      min-height: 72vh;
      padding: 96px 24px 40px;
      color: #fff;
      display: grid;
      align-items: center;
      isolation: isolate;
    }
    .home-hero::before{
      content:"";
      position:absolute; inset:0; z-index:-2;
      background-image:
        linear-gradient(to right, rgba(0,0,0,.65), rgba(0,0,0,.35)),
        image-set(
          url('https://images.unsplash.com/photo-1536104968055-4d61aa56f46a?auto=format&fit=crop&w=1600&q=80') 1x,
          url('https://images.unsplash.com/photo-1536104968055-4d61aa56f46a?auto=format&fit=crop&w=2400&q=80') 2x
        );
      background-size: cover, cover;
      background-position: center, center;
      filter: brightness(.95) contrast(1.06);
      background-attachment: fixed;
    }
    @media (max-width: 768px){
      .home-hero::before{ background-attachment: scroll; }
    }
    .home-hero::after{
      content:"";
      position:absolute; inset:0; z-index:-1;
      background:
        radial-gradient(120% 120% at 50% 0%, rgba(255,255,255,0.08), rgba(255,255,255,0) 55%),
        radial-gradient(120% 120% at 50% 100%, rgba(0,0,0,0.35), rgba(0,0,0,0) 50%);
      pointer-events:none;
    }

    .home-wrap{ max-width:1160px; margin:0 auto; padding: 0 16px; }

    .brandbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:16px; margin-bottom: 18px;
    }
    .brand{
      font-weight: 900; letter-spacing:-.02em;
      font-size: clamp(22px, 2.8vw, 28px);
      color:#fff;
    }
    .brand small{
      display:block; font-weight:600; opacity:.9; font-size:12px; letter-spacing:.2px;
    }

    .hero-grid{
      display: grid;
      grid-template-columns: 1.15fr 0.85fr;
      gap: 28px;
      align-items: center;
    }
    @media (max-width: 920px){
      .hero-grid{ grid-template-columns: 1fr; }
    }

    .hero-copy h1{
      margin: 6px 0 10px;
      font-weight: 900;
      letter-spacing: -0.02em;
      font-size: clamp(32px, 5vw, 56px);
      line-height: 1.05;
      text-shadow: 0 2px 10px rgba(0,0,0,.35);
    }
    .hero-copy p.lead{
      margin: 0 0 16px;
      max-width: 680px;
      font-size: clamp(14px, 1.9vw, 18px);
      opacity: .96;
      text-shadow: 0 2px 8px rgba(0,0,0,.35);
    }

    .cta-row{
      display:flex; flex-wrap:wrap; gap:10px; margin-top:10px;
    }
    .btn{
      display:inline-block; padding: 12px 18px; border-radius: 12px;
      border: 1px solid #fff; color:#111; background:#fff;
      font-weight: 800; cursor:pointer;
    }
    .btn.primary{ background:#ff7a00; border-color:#ff7a00; color:#fff; }
    .btn.primary:hover{ filter: brightness(1.05); transform: translateY(-1px); }
    .btn.ghost{ background:transparent; color:#fff; border-color:rgba(255,255,255,.65); }
    .btn.ghost:hover{ background:rgba(255,255,255,.12); }

    /* quick benefits */
    .benefits{
      display:grid; grid-template-columns: repeat(3, 1fr); gap: 14px; margin-top: 18px;
      max-width: 760px;
    }
    .benefit{
      display:flex; gap:10px; align-items:flex-start;
      background: rgba(255,255,255,0.12);
      border: 1px solid rgba(255,255,255,0.35);
      border-radius: 12px;
      padding: 10px 12px; color:#fff;
      backdrop-filter: blur(8px);
    }
    .benefit .icon{ width:18px; height:18px; flex:0 0 18px; }

    /* “prep hub” tiles */
    .prep{
      background:#fff; color:#111; padding: 26px 0 34px;
    }
    .prep h2{
      text-align:center; margin: 10px 0 6px; font-size: clamp(22px, 3vw, 28px);
      letter-spacing:.2px;
    }
    .prep-sub{ text-align:center; opacity:.9; margin:0 auto 18px; max-width: 820px; }
    .prep-grid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 18px; max-width: 1160px; margin: 0 auto; padding: 0 16px;
    }
    @media (max-width: 920px){ .prep-grid{ grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 520px){ .prep-grid{ grid-template-columns: 1fr; } }

    .tile{
      background:#0f1220; color:#fff; border-radius: 14px; overflow:hidden;
      border:1px solid rgba(17,17,17,.12);
      display:grid; align-content:start;
      min-height: 160px;
    }
    .tile .tile-media{
      height: 110px; background-size: cover; background-position: center;
      filter: contrast(1.05) saturate(1.05);
    }
    .tile .tile-body{ padding: 12px 14px 14px; }
    .tile h3{ margin: 0 0 6px; font-size: 16px; }
    .tile p{ margin: 0 0 10px; font-size: 14px; opacity:.92; }
    .tile .tile-cta{ display:inline-block; font-weight:700; font-size: 13px; color:#ffb86b; }

    /* social proof strip */
    .proof{
      background:#0b0c0f; color:#fff; padding: 18px 16px 24px;
      border-top:1px solid rgba(255,255,255,.08);
    }
    .proof-inner{ max-width: 1160px; margin:0 auto; }
    .proof h4{ margin:0 0 10px; opacity:.9; font-weight:800; font-size:14px; letter-spacing:.2px; color:#d9d9d9; }
    .logos{
      display:grid; grid-template-columns: repeat(6, 1fr); gap: 12px;
    }
    @media (max-width: 920px){ .logos{ grid-template-columns: repeat(3, 1fr); } }
    .logo{
      background:#12141c; border:1px solid rgba(255,255,255,.12); border-radius:10px;
      height:42px; display:grid; place-items:center; color:#9cc2ff; font-weight:800; font-size:12px;
    }

    /* testimonials / about placeholder */
    .testimonials{
      background:#fff; color:#111; padding: 24px 16px 40px; border-top:1px solid #eee;
    }
    .t-wrap{ max-width: 1160px; margin: 0 auto; }

    /* Announcement Crawler (toggle by adding .show on .crawler) */
    .crawler{
      display:none;
      position: sticky; top: 0; z-index: 3;
      background: #111827; color:#fff;
      border-bottom:1px solid rgba(255,255,255,.1);
      padding: 8px 0;
    }
    .crawler.show{ display:block; }
    .crawl-track{
      white-space: nowrap; overflow: hidden; width:100%;
    }
    .crawl-inner{
      display:inline-block; padding-left:100%;
      animation: crawl 18s linear infinite;
    }
    .crawl-inner span{ margin-right: 24px; opacity: .95; }
    @keyframes crawl{
      0%{ transform: translateX(0); }
      100%{ transform: translateX(-100%); }
    }

    /* -----------------------
       PAGE SECTIONS (unchanged below)
    ----------------------- */
    section{
      min-height: 100vh;
      padding: 60px 24px 80px;
      text-align: center;
      color: #fff;
      position: relative;
    }
    section .inner { max-width: 1100px; margin: 0 auto; position: relative; z-index: 1; }

    /* Backgrounds */
    section::before{
      content:""; position:absolute; inset:0; z-index:0;
      background: rgba(0,0,0,.45);
    }
    #course{
      background: url('https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1600&q=80') center/cover no-repeat;
    }
    #connect{
      background-image:
        image-set(
          url('https://unsplash.com/photos/oyXis2kALVg/download?force=true&w=1600') 1x,
          url('https://unsplash.com/photos/oyXis2kALVg/download?force=true&w=2400') 2x
        );
      background-position: center; background-size: cover; background-repeat: no-repeat;
    }
    #repo{
      background: url('https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=1600&q=80') center/cover no-repeat;
    }
    #repo .coming-soon{
      position: absolute; inset: 0; z-index: 5;
      display: flex; align-items: center; justify-content: center;
      background: rgba(0,0,0,0.55);
      backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
    }
    #repo .coming-soon .box{
      background: rgba(255,255,255,0.14);
      border: 1px solid rgba(255,255,255,0.35);
      border-radius: 14px; padding: 14px 18px; color: #fff;
      font-weight: 800; letter-spacing: .2px;
    }
  </style>
</head>
<body>
  <!-- Side panel -->
  <div id="side-panel" aria-hidden="true">
    <button class="panel-close" id="panel-close" aria-label="Close menu">✕</button>
    <nav class="panel-links">
      <a href="#home"   data-panel-nav>Home</a>
      <a href="#course" data-panel-nav>Blogs</a>
      <a href="#connect"data-panel-nav>Connect with me</a>
      <button type="button" class="disabled" aria-disabled="true">Repository (coming soon)</button>
    </nav>
  </div>
  <div id="scrim" aria-hidden="true"></div>

  <!-- Header / Hero -->
  <header id="home" class="active">
    <!-- announcement bar (hidden by default) -->
    <div class="crawler" id="home-crawler">
      <div class="home-wrap">
        <div class="crawl-track" aria-live="polite">
          <div class="crawl-inner">
            <span>🔥 New: Free Listening mock every Saturday</span>
            <span>🎯 Target Band 7+ roadmap available inside Course</span>
            <span>🧪 Writing Task 2 sample answers updated</span>
          </div>
        </div>
      </div>
    </div>

    <div class="home-hero">
      <div class="home-wrap">
        <div class="brandbar" aria-label="Brand">
          <div class="brand">BandForge IELTS <small>Free learning hub for IELTS aspirants</small></div>
          <div class="cta-row" role="group" aria-label="Quick actions">
            <a class="btn ghost" href="#course" data-panel-nav>Browse Lessons</a>
            <a class="btn ghost" href="#connect" data-panel-nav>Get Access Code</a>
          </div>
        </div>

        <div class="hero-grid">
          <div class="hero-copy">
            <h1>Ace your IELTS with structured lessons, mock tests, and expert tips.</h1>
            <p class="lead">Your all-in-one prep: Listening, Reading, Writing, and Speaking — organised like the big providers, but free.</p>
            <div class="cta-row">
              <a class="btn primary" href="#course" data-panel-nav>Start learning</a>
              <a class="btn ghost" href="#course" data-panel-nav>Take a practice test</a>
            </div>

            <div class="benefits" aria-label="Key benefits">
              <div class="benefit">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2l3 7h7l-5.7 4.1 2.2 6.9L12 16.9 5.5 20.9 7.7 14 2 9h7z"/></svg>
                <div>
                  <strong>Band-score focus</strong><br/>
                  Roadmaps aligned to Band 6–8+ goals.
                </div>
              </div>
              <div class="benefit">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M3 12a9 9 0 1118 0 9 9 0 01-18 0zm4-1h5V6h2v5h5v2h-5v5h-2v-5H7v-2z"/></svg>
                <div>
                  <strong>Practice first</strong><br/>
                  Mocks & answer keys with tips.
                </div>
              </div>
              <div class="benefit">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M4 6h16v2H4V6zm0 5h10v2H4v-2zm0 5h16v2H4v-2z"/></svg>
                <div>
                  <strong>Notes & checklists</strong><br/>
                  Ready-to-use study pages.
                </div>
              </div>
            </div>
          </div>

          <!-- Mini “prep hub” preview -->
          <div class="hero-cards">
            <div class="prep">
              <h2>Preparation Hub</h2>
              <p class="prep-sub">Jump straight to the skill you want to improve. Each area includes short videos, downloadable notes and practice.</p>
              <div class="prep-grid" role="list">
                <a class="tile" role="listitem" href="#course" aria-label="Listening" data-panel-nav>
                  <div class="tile-media" style="background-image:url('https://images.unsplash.com/photo-1511379938547-c1f69419868d?auto=format&fit=crop&w=1200&q=80');"></div>
                  <div class="tile-body">
                    <h3>Listening</h3>
                    <p>Strategies for sections 1–4, maps, MCQs, and more.</p>
                    <span class="tile-cta">Explore Listening →</span>
                  </div>
                </a>
                <a class="tile" role="listitem" href="#course" aria-label="Reading" data-panel-nav>
                  <div class="tile-media" style="background-image:url('https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=1200&q=80');"></div>
                  <div class="tile-body">
                    <h3>Reading</h3>
                    <p>Skimming & scanning, T/F/NG, matching headings.</p>
                    <span class="tile-cta">Explore Reading →</span>
                  </div>
                </a>
                <a class="tile" role="listitem" href="#course" aria-label="Writing" data-panel-nav>
                  <div class="tile-media" style="background-image:url('https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?auto=format&fit=crop&w=1200&q=80');"></div>
                  <div class="tile-body">
                    <h3>Writing</h3>
                    <p>Task 1 visuals & Task 2 essays with sample answers.</p>
                    <span class="tile-cta">Explore Writing →</span>
                  </div>
                </a>
                <a class="tile" role="listitem" href="#course" aria-label="Speaking" data-panel-nav>
                  <div class="tile-media" style="background-image:url('https://images.unsplash.com/photo-1518609878373-06d740f60d8b?auto=format&fit=crop&w=1200&q=80');"></div>
                  <div class="tile-body">
                    <h3>Speaking</h3>
                    <p>Part 1–3 drills, cue cards, fluency techniques.</p>
                    <span class="tile-cta">Explore Speaking →</span>
                  </div>
                </a>
              </div>
            </div>
          </div>
        </div> <!-- /hero-grid -->
      </div> <!-- /home-wrap -->
    </div> <!-- /home-hero -->

    <!-- social proof strip -->
    <div class="proof" aria-label="Trusted resources">
      <div class="proof-inner">
        <h4>Resources that students love</h4>
        <div class="logos" role="list">
          <div class="logo" role="listitem">Practice</div>
          <div class="logo" role="listitem">Tips</div>
          <div class="logo" role="listitem">Notes</div>
          <div class="logo" role="listitem">Checklists</div>
          <div class="logo" role="listitem">Samples</div>
          <div class="logo" role="listitem">Mocks</div>
        </div>
      </div>
    </div>

    <!-- about section placeholder -->
    <div class="testimonials">
      <div class="t-wrap">
        <h2>About BandForge IELTS</h2>
        <p class="prep-sub">We're just getting started! Check back soon for learner success stories and updates.</p>
      </div>
    </div>
  </header>

  <!-- ======================
       COURSE (blogs)
       ====================== -->
  <section id="course">
    <div class="inner">
      <h2>Blogs</h2>
      <p class="lead">Explore our latest blogs for tips, strategies, and insights on IELTS preparation.</p>

      <!-- Blog placeholder -->
      <div style="margin-top:34px;">
        <p>Blog posts will be added here soon. Stay tuned!</p>
      </div>

    </div>
  </section>

  <!-- ======================
       CONNECT (UNCHANGED)
       ====================== -->
  <section id="connect">
    <div class="inner">
      <div class="connect-layout">
        
        <!-- LEFT: New contact card -->
        <aside class="contact-card" aria-labelledby="contact-card-title">
          <h3 id="contact-card-title">Direct contact</h3>

          <!-- Phone -->
          <div class="item">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="currentColor" d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.03-.24c1.12.37 2.33.57 3.56.57a1 1 0 011 1v3.5a1 1 0 01-.9 1 19 19 0 01-8.1-2.3 18.85 18.85 0 01-6.56-6.56A19 19 0 013 5.9a1 1 0 011-0.9H7.5a1 1 0 011 1c0 1.23.2 2.44.57 3.56a1 1 0 01-.24 1.03l-2.2 2.2z"/>
            </svg>
            <div>
              <div class="label">Phone</div>
              <a href="tel:+91XXXXXXXXXX">+91 XXXXX XXXXX</a>
            </div>
          </div>

          <!-- Email -->
          <div class="item">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
              <path fill="currentColor" d="M20 4H4a2 2 0 00-2 2v12a2 2 0 002 2h16a2 2 0 002-2V6a2 2 0 00-2-2zm0 4.236l-8 5.333L4 8.236V6l8 5.333L20 6v2.236z"/>
            </svg>
            <div>
              <div class="label">Email</div>
              <a href="mailto:somikds3@gmail.com">somikds3@gmail.com</a>
            </div>
          </div>

          <!-- Social -->
          <div class="item" style="flex-direction:column;">
            <div class="label">Social</div>
            <div class="socials" aria-label="Social profiles">
              <a href="https://instagram.com/YOUR_HANDLE" target="_blank" rel="noopener" aria-label="Instagram">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="currentColor" d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm0 2a3 3 0 00-3 3v10a3 3 0 003 3h10a3 3 0 003-3V7a3 3 0 00-3-3H7zm5 3.5a5.5 5.5 0 110 11 5.5 5.5 0 010-11zm0 2a3.5 3.5 0 100 7 3.5 3.5 0 000-7zM18 6.4a1.1 1.1 0 110 2.2 1.1 1.1 0 010-2.2z"/>
                </svg>
              </a>
              <a href="https://www.linkedin.com/in/YOUR_HANDLE" target="_blank" rel="noopener" aria-label="LinkedIn">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="currentColor" d="M4.98 3.5a2.5 2.5 0 110 5 2.5 2.5 0 010-5zM3 8.98h3.96V21H3V8.98zM9.5 8.98H13v1.63h.05a3.85 3.85 0 013.47-1.91c3.71 0 4.39 2.44 4.39 5.61V21h-3.95v-5.36c0-1.28-.03-2.92-1.78-2.92-1.78 0-2.05 1.39-2.05 2.83V21H9.5V8.98z"/>
                </svg>
              </a>
              <a href="https://twitter.com/YOUR_HANDLE" target="_blank" rel="noopener" aria-label="X (formerly Twitter)">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="currentColor" d="M3 3h3.9l5.2 7 5.9-7H22l-7.7 9.1L22 21h-3.9l-5.6-7.6L6 21H2l8-9.5L3 3z"/>
                </svg>
              </a>
            </div>
          </div>
        </aside>

        <!-- RIGHT -->
        <div class="connect-main">
          <h2>Connect with me</h2>
          <p class="lead">Have questions or want repository access? Send me a message below.</p>

          <form class="form" id="contact-form" action="https://formspree.io/f/xovnqpnk" method="POST">
            <label for="c-name">Your name</label>
            <input id="c-name" name="name" required />

            <label for="c-phone">Phone number</label>
            <input id="c-phone" name="phone" type="tel" required />

            <label for "c-email">Email</label>
            <input id="c-email" name="email" type="email" required />

            <label for "c-msg">Your message (why you’re accessing the site)</label>
            <textarea id="c-msg" name="message" required></textarea>

            <input type="hidden" name="_subject" value="New message from IELTS site" />

            <button class="btn dark" type="submit">Submit</button>
            <div class="notice" id="contact-status" aria-live="polite"></div>
            <p class="muted">This form emails <strong>somikds3@gmail.com</strong>.</p>
          </form>
        </div>

      </div>
    </div>
  </section>

  <!-- ======================
       REPOSITORY (CODE-GATED, scrollable)
       ====================== -->
  <section id="repo">
    <div class="coming-soon">
      <div class="box">
        Repository (coming soon, stay tuned)
      </div>
    </div>

    <div class="inner">
      <h2>Repository</h2>
      <p class="lead">Enter the access code to unlock downloads. Visit the 'Connect with me' section, to get your access code.</p>

      <!-- Gate -->
      <div id="repo-gate">
        <form class="form" id="repo-code-form" autocomplete="off">
          <label for="repo-code">Access code</label>
          <input id="repo-code" name="code" required />
          <button class="btn dark" type="submit">Unlock</button>
          <div class="notice" id="repo-note"></div>
        </form>
      </div>

      <!-- Unlocked content -->
      <div id="repo-content" style="display:none;">
        <p class="lead">Access granted ✔ You can add your files/links here.</p>
        <p><a class="btn" href="/files/notes1.pdf">Download Notes 1</a></p>

        <!-- Owner-only: appears only if ownerMode === true -->
        <button id="lock-repo" class="btn" style="display:none;">Lock repository</button>
        <p class="muted" id="owner-hint" style="display:none;">Owner mode is ON. Add <code>?owner=1</code> once to this URL to enable it on your device.</p>
      </div>
    </div>
  </section>

  <script>
    /* =======================
       OWNER MODE (Option A)
       - Visit once with ?owner=1 to enable owner mode on your device.
       - Persists via localStorage.
    ======================= */
    const ownerMode =
      /[?&]owner=1\b/.test(location.search) ||
      localStorage.getItem('ownerMode') === 'true';

    if (ownerMode) localStorage.setItem('ownerMode', 'true');

    /* =======================
       REPO ACCESS CODE
       - CHANGE THIS to your secret code.
       - Comparison is case-sensitive by default.
    ======================= */
    const ACCESS_CODE = "IELTS-ACCESS-2025"; // <--- change me

    /* =======================
       SINGLE-VIEW ROUTER
       - Home + Connect => non-scroll page
       - Course + Repo  => scrollable page
    ======================= */
    const SECTION_IDS = ["home", "course", "connect", "repo"];
    const bodyEl = document.body;

    function showOnly(id){
      SECTION_IDS.forEach(secId => {
        const el = document.getElementById(secId);
        if (!el) return;
        el.classList.remove("active");
      });
      const target = document.getElementById(id);
      if (target) target.classList.add("active");

      // Always allow page scrolling
      bodyEl.classList.remove("no-scroll");

      history.replaceState(null, "", `#${id}`);

      // If we navigated to repo, re-evaluate lock state (handles expiry)
      if (id === "repo") renderRepoUI();
    }

    // Respect initial hash
    window.addEventListener('load', ()=>{
      const id = (location.hash || "#home").replace("#","");
      showOnly(SECTION_IDS.includes(id) ? id : "home");
    });

    /* =======================
       PANEL OPEN/CLOSE
    ======================= */
    const hamburger = document.getElementById('hamburger');
    const panel     = document.getElementById('side-panel');
    const scrim     = document.getElementById('scrim');
    const panelClose= document.getElementById('panel-close');

    function openPanel(){
      panel.classList.add('open');
      scrim.classList.add('show');
      panel.setAttribute('aria-hidden','false');
      scrim.setAttribute('aria-hidden','false');
      hamburger.setAttribute('aria-expanded','true');
    }
    function closePanel(){
      panel.classList.remove('open');
      scrim.classList.remove('show');
      panel.setAttribute('aria-hidden','true');
      scrim.setAttribute('aria-hidden','true');
      hamburger.setAttribute('aria-expanded','false');
    }
    hamburger.addEventListener('click', openPanel);
    panelClose.addEventListener('click', closePanel);
    scrim.addEventListener('click', closePanel);
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closePanel(); });

    /* =======================
       REPOSITORY GATE
       - Auto-lock on tab close (new session)
       - Lock after 3 hours
    ======================= */
    const THREE_HOURS_MS = 3 * 60 * 60 * 1000;

    const repoGate    = document.getElementById('repo-gate');
    const repoForm    = document.getElementById('repo-code-form');
    const repoNote    = document.getElementById('repo-note');
    const repoContent = document.getElementById('repo-content');
    const lockBtn     = document.getElementById('lock-repo');
    const ownerHint   = document.getElementById('owner-hint');

    function clearRepoUnlock(){
      localStorage.removeItem('repoUnlocked');
      localStorage.removeItem('repoUnlockedAt');
    }

    function isRepoUnlocked(){
      const flag = localStorage.getItem('repoUnlocked') === '1';
      const at   = parseInt(localStorage.getItem('repoUnlockedAt') || '0', 10);
      if (!flag || !at) return false;

      const age = Date.now() - at;
      if (age > THREE_HOURS_MS){
        clearRepoUnlock();
        return false;
      }
      return true;
    }

    function renderRepoUI(){
      const unlocked = isRepoUnlocked();
      repoGate.style.display    = unlocked ? 'none' : '';
      repoContent.style.display = unlocked ? '' : 'none';

      // Owner-only lock button visibility
      lockBtn.style.display   = (unlocked && ownerMode) ? '' : 'none';
      ownerHint.style.display = ownerMode ? '' : 'none';
    }

    // New session = tab just opened => force lock
    window.addEventListener('load', ()=>{
      if (!sessionStorage.getItem('sessionActive')) {
        clearRepoUnlock();                 // lock at the start of a new tab session
        sessionStorage.setItem('sessionActive', '1');
      }
      renderRepoUI();
    });

    repoForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      const code = (document.getElementById('repo-code').value || '').trim();
      if (code === ACCESS_CODE){
        localStorage.setItem('repoUnlocked', '1');
        localStorage.setItem('repoUnlockedAt', String(Date.now()));
        repoNote.textContent = 'Access granted ✔';
        renderRepoUI();
      } else {
        repoNote.textContent = 'Incorrect code. Please try again.';
      }
    });

    // Owner can re-lock anytime
    lockBtn.addEventListener('click', ()=>{
      clearRepoUnlock();
      renderRepoUI();
    });

    /* =======================
       SIDE-PANEL NAV (iOS fix)
       Close panel first, then swap section on next frame.
    ======================= */
    document.querySelectorAll('[data-panel-nav]').forEach(link=>{
      link.addEventListener('click', (e)=>{
        e.preventDefault();
        const id = (link.getAttribute('href') || "").slice(1);
        closePanel();
        requestAnimationFrame(()=>{ requestAnimationFrame(()=> showOnly(id)); });
      });
    });

    // (Keep explicit repo click behavior consistent with the same fix)
    document.querySelectorAll('a[href="#repo"]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        e.preventDefault();
        closePanel();
        requestAnimationFrame(()=>{ requestAnimationFrame(()=> showOnly('repo')); });
      });
    });

    /* =======================
       CONTACT FORM (Formspree)
       - Progressive enhancement: AJAX submit for inline feedback.
    ======================= */
    const contactForm = document.getElementById('contact-form');
    const contactStatus = document.getElementById('contact-status');

    if (contactForm) {
      contactForm.addEventListener('submit', async (e)=>{
        e.preventDefault();
        contactStatus.textContent = 'Sending…';

        const formData = new FormData(contactForm);
        try{
          const res = await fetch(contactForm.action, {
            method: 'POST',
            headers: { 'Accept': 'application/json' },
            body: formData
          });
          if (res.ok){
            contactStatus.textContent = 'Thanks! Your message has been sent.';
            contactForm.reset();
          } else {
            contactStatus.textContent = 'Hmm, something went wrong. Please try again.';
          }
        } catch(err){
          contactStatus.textContent = 'Network error. Please try again.';
        }
      });
    }
  </script>
</body>
</html>